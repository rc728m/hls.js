<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>hls.js demo</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.3/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.2/ace.js"></script>
    <script src="https://unpkg.com/read-excel-file@4.x/bundle/read-excel-file.min.js"></script>
  </head>
  <body>
    <div class="container">
    <div class="header-container">
      <header class="wrapper clearfix">
        <h1>
          <a target="_blank" href="https://github.com/video-dev/hls.js">
            <img src="https://cloud.githubusercontent.com/assets/616833/19739063/e10be95a-9bb9-11e6-8100-2896f8500138.png"/>
          </a>
        </h1>

        <h2 class="title1">
          Merged_Demo_v1
        </h2>

         
      </header>
    </div>

    <div class="main-container">
       
      <div id="controls">
        <div class="demo-controls-wrapper">
          <select id="streamSelect" class="innerControls">
            <option value="" selected>Select  atest-stream from drop-down menu. Or enter custom URL below</option>
          </select>

          <input id="streamURL" class="innerControls" type=text value=""/>

          <label class="innerControls">
            Enable streaming:
            <input id="enableStreaming" type=checkbox checked/>
          </label>

          <label class="innerControls">
            Auto-recover media-errors:
            <input id="autoRecoverError" type=checkbox checked/>
          </label>

          <label class="innerControls">
            Dump transmuxed fMP4 data:
            <input id="dumpfMP4" type=checkbox unchecked/>
          </label>

          <label class="innerControls">
            Metrics history (max limit, -1 is unlimited):
            <input id="limitMetrics" style="width: 8em" type=number/>
          </label>

          <label class="innerControls">
            HTML video element width:
            <select id="videoSize" style="float:right;">
              <option value="240px">240px</option>
              <option value="426px">426px</option>
              <option value="640px">640px</option>
              <option value="720px">720px</option>
              <option value="854px">854px</option>
              <option value="1280px">1280px</option>
              <option value="1920px">1920px</option>
              <option value="80%">Responsive (80%)</option>
              <option value="100%">Responsive (100%)</option>
            </select>
          </label>

          <label class="innerControls">
            Current player size:
            <span id="currentSize"></span>
          </label>
          <label class="innerControls">
            Current video resolution:
            <span id="currentResolution"></span>
          </label>

          <label class="innerControls">
            Permalink:
            <span id="StreamPermalink"></span>
          </label>
        </div>

        <div class="config-editor-wrapper">
          <div class="config-editor-container">
              <div id="config-editor">
                Loading...
              </div>
          </div>
          <div class="config-editor-commands">
            <label for="config-persistence">
                Persist
                <input name="config-persistence" id="config-persistence" type="checkbox">
            </label>
            <button name="config-apply" onclick="applyConfigEditorValue()">Apply</button>
          </div>
        </div>

      </div>
      <div class="row">
        <div class="mx-auto col-9">
          <video width="100%"  id="video" controls autoplay></video>
           <br>
          <canvas id="bufferedCanvas" width="720" height="15" class="videoCentered" onclick="onClickBufferedRange(event);" style="height: fit-content;"></canvas>
          <select id="network" onchange = "networkChange()">
            <option value="37500000" selected="selected">WIFI</option>
            <option value="4375000">DSL</option>
            <option value="2000000">Regular 4G</option>
            <option value="250000">Good 3G</option>
            <option value="48000">Regular 3G</option>
            <option value="6400">Good 2G</option>
            <option value="5000">Regular 2G</option>
            <option value="4375">GPRS</option>
          </select>
          <p>When a new bitrate is choosen the Quality will be dropped after the entire buffered section of the previous bandwidth is played. Keep in mind that as soon as you lower the bandwidth's bitrate the player will begin to downloading quicker. </p>
          <div style="width: 500px; height: 250px;">
              <canvas id="bitrateGraphCSULA" ></canvas>
          </div>
          <div style="width: 500px; height: 250px;">
            <canvas id="line-chart"></canvas>
        </div>
        </div>
        <style type="text/css">
          mark {
            background-color: lightblue;
          }
          .mark2{
            background-color: pink;

          }
        </style>
        <div class="col-3">
          <div>Current Time: <span id="currentTime">0</span></div>
		      <div>Duration: <span id="Duration">0</span></div>
		      <div>Watched Percentage: <span id="watchedPercent">0</span></div>
          <div>Initial Startup Time: <span id="VSTinitial">0</span></div>
          <div>Video Start Time: <span id="VSTcontinuous">0</span></div>           
          <div>Video Resolution: <span id="resolution">0</span></div>
          <div>Buffer Count: <span id="rebufferCount">0</span></div>
		      <div>Buffer Size: <span id="bufferSize"></span></div>
          <div>Buffer Duration: <span id="bufferDuration">0</span></div>
          <div>Total Rebuffer Time: <span id="totalRebufferTime">0</span></div>      
          <div>Rebuffer Ratio: <span id="demo">0</span></div>
          <div>Play Time: <span id="time3">0</span></div>
          <div>Pause Count: <span id="pauseCount">0</span></div>
          <div>Total Pause Time: <span id="totalPauseTime">0</span></div>
          <div>Estimated Frames Per Second: <span id="Fps">0</span></div>      
          <div>Total Decoded Frames: <span id="DecodedFps">0</span></div>
          <div>Dropped Frames: <span id="DroppedFps">0</span></div>
          <div>Estimated Bandwidth: <span id="Bandwidth"></span></div>
          <div>Session Time: <span id="sessionTime"></span></div>
          <div>Play Count: <span id="playcounter"></span></div>
          <div>Seek Count: <span id="seekCount"></span></div>
          <div>Volume: <span id="Volume"></span></div>
          <div>Full Screen Count: <span id="fullScreenCount">0</span></div>
          <div>Error Count: <span id="errorCount">0</span></div>
          <div>Level Changed Counter: <span id="changeLevelCounter">0</span></div>
          <div><mark>Current Level: <span id="currentlevel">0</span></mark></div>
          <div><mark>Level Change History: [Loading<span id="levelchangehistory"></span>]</mark></div>
          <div><mark>Current Bitrate: <span id="currentBitrate">0</span></mark></div>
          <div><mark>Bitrate Change History: [Loading<span id="bitrateChange"></span>]</mark></div>
          <div><mark>Bitrate Mean: <span id="bitrateMean">0</span></mark></div>
		  <div><input type="file" name="inputfile" id="inputfile"> </div>
        </div>
      </div>  
      <br>
      <br>
      <label class="center">Status:</label>
      <pre id="statusOut" class="center" style="white-space: pre-wrap;"></pre>

      <label class="center">Error:</label>
      <pre id="errorOut" class="center" style="white-space: pre-wrap;"></pre>

      <div class="center" style="text-align: center; display: none;" id="toggleButtons">
        <button type="button" class="btn btn-sm demo-tab-btn" data-tab="playbackControlTab" onclick="toggleTab(this);">Playback</button>
        <button type="button" class="btn btn-sm demo-tab-btn" data-tab="timelineTab" onclick="toggleTab(this);">Timeline</button>
        <button type="button" class="btn btn-sm demo-tab-btn" data-tab="qualityLevelControlTab" onclick="toggleTab(this);">Quality-levels</button>
        <button type="button" class="btn btn-sm demo-tab-btn" data-tab="audioTrackControlTab" onclick="toggleTab(this);">Audio-tracks</button>
        <button type="button" class="btn btn-sm demo-tab-btn" data-tab="metricsDisplayTab" onclick="toggleTab(this); showMetrics();">Real-time metrics</button>
        <button type="button" class="btn btn-sm demo-tab-btn" data-tab="statsDisplayTab" onclick="toggleTab(this);">Buffer &amp; Statistics</button>
      </div>

      <div class="center demo-tab" id="playbackControlTab" style="display: none;">
        <br>
        <center>
          <p>
            <span>
                <button type="button" class="btn btn-sm btn-info" title="video.play()" onclick="$('#video')[0].play()">Play</button>
                <button type="button" class="btn btn-sm btn-info" title="video.pause()" onclick="$('#video')[0].pause()">Pause</button>
            </span>
              <span>
              <button type="button" class="btn btn-sm btn-info" title="video.currentTime -= 10" onclick="$('#video')[0].currentTime-=10">- 10 s</button>
              <button type="button" class="btn btn-sm btn-info" title="video.currentTime += 10" onclick="$('#video')[0].currentTime+=10">+ 10 s</button>
            </span>
              <span>
              <button type="button" class="btn btn-sm btn-info" title="video.currentTime = text input" onclick="$('#video')[0].currentTime=$('#seek_pos').val()">Seek to </button>
              <input type="number" id='seek_pos' size="8" onkeydown="if(window.event.keyCode=='13'){$('#video')[0].currentTime=$('#seek_pos').val();}">
            </span>
          </p>
          <p>
          <span>
              <button type="button" class="btn btn-xs btn-warning" title="hls.startLoad()" onclick="hls.startLoad()">Start loading</button>
              <button type="button" class="btn btn-xs btn-warning" title="hls.stopLoad()" onclick="hls.stopLoad()">Stop loading</button>
            </span>
            <span>
              <button type="button" class="btn btn-xs btn-warning" title="hls.attachMedia(video)" onclick="hls.attachMedia($('#video')[0])">Attach media</button>
              <button type="button" class="btn btn-xs btn-warning" title="hls.detachMedia()" onclick="hls.detachMedia()">Detach media</button>
            </span>
          </p>
          <p>
            <span>
              <button type="button" class="btn btn-xs btn-warning" title="hls.recoverMediaError()" onclick="hls.recoverMediaError()">Recover media-error</button>
              <button type="button" class="btn btn-xs btn-warning" title="hls.swapAudioCodec()" onclick="hls.swapAudioCodec()">Swap audio codec</button>
            </span>
          </p>
          <p>
            <span>
              <button type="button" class="btn btn-xs btn-default" onclick="$('#streamSelect')[0].selectedIndex++;$('#streamSelect').change()">Next video</button>
              <button type="button" class="btn btn-xs btn-default btn-dump" title="Save dumped audio mp4 appends" onclick="createfMP4('audio');">Create audio-fmp4</button>
              <button type="button" class="btn btn-xs btn-default btn-dump" title="Save dumped video mp4 appends" onclick="createfMP4('video')">Create video-fmp4</button>
            </span>
          </p>
        </center>
      </div>

      <div class="center demo-tab demo-timeline-chart-container" id="timelineTab" style="display: none;">
        <canvas id="timeline-chart"></canvas>
      </div>

      <div class="center demo-tab" id="qualityLevelControlTab" style="display: none;">
        <center>
            <table>
                <tr>
                  <td>
                    <p>Currently played level:</p>
                  </td>
                  <td>
                    <div id="currentLevelControl" style="display: inline;"></div>
                  </td>
                </tr>
                <tr>
                  <td>
                    <p>Next level loaded:</p>
                  </td>
                  <td>
                    <div id="nextLevelControl" style="display: inline;"></div>
                  </td>
                </tr>
                <tr>
                  <td>
                    <p>Currently loaded level:</p>
                  </td>
                  <td>
                    <div id="loadLevelControl" style="display: inline;"></div>
                  </td>
                </tr>
                <tr>
                  <td>
                    <p>Cap-limit level (maximum):</p>
                  </td>
                  <td>
                    <div id="levelCappingControl" style="display: inline;"></div>
                  </td>
                </tr>
              </table>
        </center>
      </div>

      <div class="center demo-tab" id="audioTrackControlTab" style="display: none;">
        <table>
          <tr>
            <td>Current audio-track:</td>
            <td><div id="audioTrackControl" style="display: inline;"></div></td>
          </tr>
          <tr>
            <td>Language / Name:</td>
            <td><div id="audioTrackLabel" style="display: inline;">None selected</div></td>
          </tr>
        </table>
      </div>

      <div class="center demo-tab" id="metricsDisplayTab" style="display: none;">
        <br>
        <div id="metricsButton">
          <button type="button" class="btn btn-xs btn-info" onclick="$('#metricsButtonWindow').toggle();$('#metricsButtonFixed').toggle();windowSliding=!windowSliding; refreshCanvas()">toggle sliding/fixed window</button><br>
          <div id="metricsButtonWindow">
            <button type="button" class="btn btn-xs btn-info" onclick="timeRangeSetSliding(0)">window ALL</button>
            <button type="button" class="btn btn-xs btn-info" onclick="timeRangeSetSliding(2000)">2s</button>
            <button type="button" class="btn btn-xs btn-info" onclick="timeRangeSetSliding(5000)">5s</button>
            <button type="button" class="btn btn-xs btn-info" onclick="timeRangeSetSliding(10000)">10s</button>
            <button type="button" class="btn btn-xs btn-info" onclick="timeRangeSetSliding(20000)">20s</button>
            <button type="button" class="btn btn-xs btn-info" onclick="timeRangeSetSliding(30000)">30s</button>
            <button type="button" class="btn btn-xs btn-info" onclick="timeRangeSetSliding(60000)">60s</button>
            <button type="button" class="btn btn-xs btn-info" onclick="timeRangeSetSliding(120000)">120s</button><br>
            <button type="button" class="btn btn-xs btn-info" onclick="timeRangeZoomIn()">Window Zoom In</button>
            <button type="button" class="btn btn-xs btn-info" onclick="timeRangeZoomOut()">Window Zoom Out</button><br>
            <button type="button" class="btn btn-xs btn-info" onclick="timeRangeSlideLeft()"> <<< Window Slide </button>
            <button type="button" class="btn btn-xs btn-info" onclick="timeRangeSlideRight()">Window Slide >>> </button><br>
          </div>
          <div id="metricsButtonFixed">
            <button type="button" class="btn btn-xs btn-info" onclick="windowStart=$('#windowStart').val()">fixed window start(ms)</button>
            <input type="text" id='windowStart' defaultValue="0" size="8" onkeydown="if(window.event.keyCode=='13'){windowStart=$('#windowStart').val();}">
            <button type="button" class="btn btn-xs btn-info" onclick="windowEnd=$('#windowEnd').val()">fixed window end(ms)</button>
            <input type="text" id='windowEnd' defaultValue="10000" size="8" onkeydown="if(window.event.keyCode=='13'){windowEnd=$('#windowEnd').val();}"><br>
          </div>
          <button type="button" class="btn btn-xs btn-success" onclick="goToMetrics()" style="font-size:18px">metrics link</button>
          <button type="button" class="btn btn-xs btn-success" onclick="goToMetricsPermaLink()" style="font-size:18px">metrics permalink</button>
          <button type="button" class="btn btn-xs btn-success" onclick="copyMetricsToClipBoard()" style="font-size:18px">copy metrics to clipboard</button>
          <canvas id="bufferTimerange_c" width="640" height="100" style="border:1px solid #000000" onmousedown="timeRangeCanvasonMouseDown(event)" onmousemove="timeRangeCanvasonMouseMove(event)" onmouseup="timeRangeCanvasonMouseUp(event)" onmouseout="timeRangeCanvasonMouseOut(event);"></canvas>
          <canvas id="bitrateTimerange_c" width="640" height="100" style="border:1px solid #000000;"></canvas>
          <canvas id="bufferWindow_c" width="640" height="100" style="border:1px solid #000000" onmousemove="windowCanvasonMouseMove(event);"></canvas>
          <canvas id="videoEvent_c" width="640" height="15" style="border:1px solid #000000;"></canvas>
          <canvas id="loadEvent_c" width="640" height="15" style="border:1px solid #000000;"></canvas><br>
        </div>
      </div>

      <div class="center demo-tab" id="statsDisplayTab" style="display: none;">
        <br>
        <label>Buffer state:</label>
        <pre id="bufferedOut"></pre>
        <label>General stats:</label>
        <pre id="statisticsOut"></pre>
      </div>

      
    </div>
    </div>

    <footer>
      <br><br><br><br><br><br>
    </footer>
    
    <!-- Demo page required libs -->
    <script src="canvas.js"></script>
    <script src="metrics.js"></script>
    <script src="libs/jsonpack.js"></script>s

    <!-- demo build -->
    <script src = "ourmetrics.js"></script>
    <script src="hls.js"></script>
    <script src="hls-demo.js"></script>
    <!-- CSULA required libs -->
    <script type="text/javascript" src="Chart.js"></script>
    <script type="text/javascript" src="MyBitrateChart.js"></script> 
    <script type="text/javascript" src="NetworkProfiles.js"></script>  
  </body>
</html>